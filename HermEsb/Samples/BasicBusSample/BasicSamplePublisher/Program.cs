using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using BasicSampleContracts;
using HermEsb.Configuration;

namespace BasicSamplePublisher
{
    class Program
    {
        static void Main(string[] args)
        {
            var busPublisher = ConfigurationPublisher.With("config/publisher.xml")
                                                .Log4NetBuilder("config/logging.xml")
                                                .ConfigurePublisher()
                                                .Create();

            Console.WriteLine("Pulsa una tecla para enviar un mensaje, pulsa X para salir.");
            while (true)
            {
                var key = Console.ReadKey(true);
                if (key.KeyChar == 'x' || key.KeyChar == 'X') break;
                var messageBasic = busPublisher.MessageBuilder.CreateInstance<MessageBasic>(basic =>
                {
                    basic.Fecha = DateTime.UtcNow;
                    basic.Nombre = "{\"_id\" : ObjectId(\"525be07c2cdb872cd81f1b96\"),\"Version\" : NumberLong(\"635173497588016349\"),\"EventosAplicados\" : [\"Operativa.UI.Bulto.Mediator.Domain.Events.BultoCompletadoDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.ItinerarioDeterminadoDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.ItinerarioValoradoDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.DatosComplementariosInformadosDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.DatosEnvioActualizadosDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.CambioEstadoEnvioDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.BultoFinalizadoDomainEvent\", \"Operativa.UI.Bulto.Mediator.Domain.Events.CambioEstadoEnvioDomainEvent\"],\"Eliminado\" : false,\"IdEnvio\" : ObjectId(\"525be07c2cdb872cd81f1b97\"),\"Localizador\" : \"2\",\"IdRecogida\" : ObjectId(\"525be07c2cdb872cd81f1b8d\"),\"IdEntrega\" : ObjectId(\"525be07c2cdb872cd81f1b90\"),\"Referencias\" : [\"\"],\"Embalaje\" : {\"TipoEmbalaje\" : {\"Codigo\" : \"Personalizado\",\"Familia\" : \"Personalizado\"},\"Caracteristicas\" : {\"Dimensiones\" : {\"Alto\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\",\"Ancho\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\",\"Largo\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\"},\"Peso\" : \"{\"Measurement\":\"1Kg\",\"_value\":1}\"},\"TipoMercancia\" : {\"Tipo\" : \"Documentos\"},\"Complemento\" : null},\"Peso\" : \"{\"Measurement\":\"1Kg\",\"_value\":1}\",\"CodigoRuta\" : \"19\",\"Segmentos\" : [{\"Inicio\" : \"OFF0000626\",\"Final\" : \"OFF0000626\",\"Distancia\" : 0.0}],\"Origen\" : {\"Punto\" : {\"CodigoPunto\" : \"OFF0000626\",\"TipoPunto\" : \"OFF\",\"DireccionPunto\" : {\"IdPais\" : \"ES\",\"NombrePais\" : \"ESPAÑA\",\"IdRegion\" : \"10\",\"DescripcionRegion\" : \"CATALUNYA\",\"TipoVia\" : \"CL\",\"DescripcionVia\" : null,\"NombreVia\" : \"FRANCESC VILA\",\"NumeroVia\" : \"0\",\"Planta\" : null,\"Puerta\" : null,\"CodigoPostal\" : \"08190\",\"Poblacion\" : \"SANT CUGAT DEL VALLES\",\"Provincia\" : \"BARCELONA\",\"InfoAdicionalEdificio\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\",\"Zona\" : \"EspañaPeninsular\"}},\"Direccion\" : null,\"Kilometros\" : 0.0},\"Destino\" : {\"Punto\" : {\"CodigoPunto\" : \"OFF0000626\",\"TipoPunto\" : \"OFF\",\"DireccionPunto\" : {\"IdPais\" : \"ES\",\"NombrePais\" : \"ESPAÑA\",\"IdRegion\" : \"10\",\"DescripcionRegion\" : \"CATALUNYA\",\"TipoVia\" : \"CL\",\"DescripcionVia\" : null,\"NombreVia\" : \"FRANCESC VILA\",\"NumeroVia\" : \"0\",\"Planta\" : null,\"Puerta\" : null,\"CodigoPostal\" : \"08190\",\"Poblacion\" : \"SANT CUGAT DEL VALLES\",\"Provincia\" : \"BARCELONA\",\"InfoAdicionalEdificio\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\",\"Zona\" : \"EspañaPeninsular\"}},\"Direccion\" : null,\"Kilometros\" : 0.0},\"Saca\" : {\"Codigo\" : \"BARCELONA\",\"Numero\" : \"0\",\"Sigla\" : \"BCN\"},\"DatosEntrega\" : {\"FechaEntrega\" : ISODate(\"2013-10-15T12:15:00Z\"),\"PuntoCliente\" : {\"Punto\" : {\"CodigoPunto\" : \"OFF0000626\",\"TipoPunto\" : \"OFF\",\"DireccionPunto\" : {\"IdPais\" : \"ES\",\"NombrePais\" : \"ESPAÑA\",\"IdRegion\" : \"10\",\"DescripcionRegion\" : \"CATALUNYA\",\"TipoVia\" : \"CL\",\"DescripcionVia\" : null,\"NombreVia\" : \"FRANCESC VILA\",\"NumeroVia\" : \"0\",\"Planta\" : null,\"Puerta\" : null,\"CodigoPostal\" : \"08190\",\"Poblacion\" : \"SANT CUGAT DEL VALLES\",\"Provincia\" : \"BARCELONA\",\"InfoAdicionalEdificio\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\",\"Zona\" : \"EspañaPeninsular\"}},\"Direccion\" : null,\"Kilometros\" : 0.0},\"HoraLimiteEntrega\" : ISODate(\"2013-10-15T12:15:00Z\"),\"TramoHorario\" : \"null null null null\",\"Observaciones\" : \"\",\"Contacto\" : \"525be07c2cdb872cd81f1b8b\"},\"DatosRecogida\" : {\"FechaRecogida\" : ISODate(\"2013-10-14T12:15:00Z\"),\"PuntoCliente\" : {\"Punto\" : {\"CodigoPunto\" : \"OFF0000626\",\"TipoPunto\" : \"OFF\",\"DireccionPunto\" : {\"IdPais\" : \"ES\",\"NombrePais\" : \"ESPAÑA\",\"IdRegion\" : \"10\",\"DescripcionRegion\" : \"CATALUNYA\",\"TipoVia\" : \"CL\",\"DescripcionVia\" : null,\"NombreVia\" : \"FRANCESC VILA\",\"NumeroVia\" : \"0\",\"Planta\" : null,\"Puerta\" : null,\"CodigoPostal\" : \"08190\",\"Poblacion\" : \"SANT CUGAT DEL VALLES\",\"Provincia\" : \"BARCELONA\",\"InfoAdicionalEdificio\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\",\"Zona\" : \"EspañaPeninsular\"}},\"Direccion\" : null,\"Kilometros\" : 0.0},\"RangoHorario\" : \"null null null null\",\"Observaciones\" : \"\",\"HoraMaxima\" : ISODate(\"2013-10-14T12:15:00Z\"),\"Contacto\" : ObjectId(\"525be07c2cdb872cd81f1b8c\")},\"DatosServicio\" : {\"IdServicio\" : \"U10\",\"HoraMaximaEntrega\" : ISODate(\"2013-10-14T12:15:57.794Z\"),\"UnidadesValoracion\" : 1.0,\"Plan\" : null,\"TipoCobro\" : 0,\"Frecuencia\" : 0,\"CantidadPrepagados\" : 0},\"DatosItinerario\" : {\"IdBulto\" : ObjectId(\"525be07c2cdb872cd81f1b96\"),\"Localizador\" : \"2\",\"IdRecogida\" : ObjectId(\"525be07c2cdb872cd81f1b8d\"),\"IdEntrega\" : ObjectId(\"525be07c2cdb872cd81f1b90\"),\"Embalaje\" : {\"TipoEmbalaje\" : {\"Codigo\" : \"Personalizado\",\"Familia\" : \"Personalizado\"},\"Caracteristicas\" : {\"Dimensiones\" : {\"Alto\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\",\"Ancho\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\",\"Largo\" : \"{\"Measurement\":\"10cm\",\"_value\":10}\"},\"Peso\" : \"{\"Measurement\":\"1Kg\",\"_value\":1}\"},\"TipoMercancia\" : {\"Tipo\" : \"Documentos\"},\"Complemento\" : null},\"Peso\" : \"{\"Measurement\":\"1Kg\",\"_value\":1}\",\"CodigoRuta\" : \"19\",\"Segmentos\" : [{\"Inicio\" : \"OFF0000626\",\"Final\" : \"OFF0000626\",\"Distancia\" : 0.0}]},\"LocalizadorEnvio\" : \"00626G300001\",\"Fecha\" : ISODate(\"2013-10-14T12:15:56.294Z\"),\"FranquiciaSolicitante\" : \"OFF0000626\",\"ReferenciaCliente\" : [],\"Observaciones1\" : \"\",\"Observaciones2\" : \"\",\"GeneradoPor\" : null,\"OperadorTomaServicio\" : null,\"ImpresionEtiquetasContador\" : 0,\"Nic\" : \"BBB3709ES00626\",\"NifOrigenEnvios\" : null,\"NifDestinoEnvios\" : null,\"ValorEnvios\" : \"0\",\"Importe\" : 0.0,\"Tipo\" : \"\",\"ComentarioAnomalia\" : null,\"TipoComision\" : null,\"TipoGeografico\" : 0,\"TantoPorCientoIva\" : 0.0,\"TantoPorCientoComision\" : 0.0,\"ImporteComision\" : 0.0,\"ImporteIva\" : 0.0,\"ImporteTotal\" : \"0\",\"IndicadorReembolsoTercera\" : null,\"CantidadBultos\" : 2,\"MensajeroEntrega\" : null,\"MensajeroRecogida\" : null,\"CodigoMensajeroEntrega\" : null,\"CodigoMensajeroRecogida\" : null,\"EstadoRecogida\" : null,\"Estado\" : \"RecogidaPendiente\",\"Motivo\" : null,\"Fase\" : \"Recogida\",\"Anomalia\" : false,\"FechaRecogidaFinalizada\" : null,\"DatosContactoRecogida\" : [{\"Tipo\" : 0,\"Valor\" : \"867547236\"}, {\"Tipo\" : 2,\"Valor\" : \"Lego\"}],\"NifRecogida\" : \"46853214J\",\"NombreRecogida\" : \"Lego\",\"DatosContactoEntrega\" : [],\"NifEntrega\" : \"\",\"NombreEntrega\" : \"Prueba\",\"DatosContactoFranquiciaRecogida\" : [{\"TipoNumero\" : \"EM\",\"Numero\" : \"00626@GRUPOMRW.COM\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}, {\"TipoNumero\" : \"TE\",\"Numero\" : \"93-5902680\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}, {\"TipoNumero\" : \"FA\",\"Numero\" : \"93-5902688\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}],\"DireccionesFranquiciaRecogida\" : [{\"CodigoPostal\" : \"08190\",\"TipoVia\" : \"ECL\",\"NombreTipoVia\" : \"CALLE\",\"Direccion\" : \"FRANCESC VILA\",\"Numero\" : \"0\",\"Otros\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\"}],\"NombreFranquiciaRecogida\" : \"SANT CUGAT DEL VALLES\",\"DatosContactoFranquiciaEntrega\" : [{\"TipoNumero\" : \"EM\",\"Numero\" : \"00626@GRUPOMRW.COM\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}, {\"TipoNumero\" : \"TE\",\"Numero\" : \"93-5902680\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}, {\"TipoNumero\" : \"FA\",\"Numero\" : \"93-5902688\",\"Observaciones\" : \"\",\"PorDefecto\" : \"True\"}],\"DireccionesFranquiciaEntrega\" : [{\"CodigoPostal\" : \"08190\",\"TipoVia\" : \"ECL\",\"NombreTipoVia\" : \"CALLE\",\"Direccion\" : \"FRANCESC VILA\",\"Numero\" : \"0\",\"Otros\" : \"NAVE,7 POLIGONO INDUSTRIAL CAN MAGI\"}],\"NombreFranquiciaEntrega\" : \"SANT CUGAT DEL VALLES\",\"Codigo\" : \"OFF0000626\",\"Empresa\" : \"BEDOS,IBAÑEZ,TRULLOLS,S.L\",\"Nif\" : \"B60176542\",\"Producto\" : {\"CodigoServicio\" : \"U10\",\"Descripcion\" : \"URGENTE 10\",\"DescripcionCorta\" : \"URG10\",\"FechaInicioVigencia\" : ISODate(\"2012-01-01T00:00:00Z\"),\"FechaFinVigencia\" : ISODate(\"9999-12-31T00:00:00Z\"),\"TipoServicio\" : \"Comercial\",\"Caracteristicas\" : []},\"DatosCliente\" : {\"IdCliente\" : ObjectId(\"5256eb2d2cdb8727dc86af50\"),\"IdCeco\" : ObjectId(\"5256eb2d1efe9506204a8f68\"),\"CodigoAbonado\" : \"000000\",\"CodigoDept\" : null,\"Nim\" : \"BBB3709ES\",\"Nic\" : \"BBB3709ES00626\",\"IdFiscal\" : \"468563214J\",\"Nombre\" : \"Lego\",\"Franquicia\" : \"00626\",\"Modalidad\" : null,\"TipoContrato\" : null,\"FormaJuridica\" : null,\"TipoCliente\" : null,\"Telefono\" : null,\"EsGenerico\" : false},\"ClienteAcuerdoComercial\" : {\"IdCliente\" : ObjectId(\"5256eb2d2cdb8727dc86af50\"),\"IdCeco\" : ObjectId(\"5256eb2d1efe9506204a8f68\"),\"CodigoAbonado\" : \"000000\",\"CodigoDept\" : null,\"Nim\" : \"BBB3709ES\",\"Nic\" : \"BBB3709ES00626\",\"IdFiscal\" : \"468563214J\",\"Nombre\" : \"Lego\",\"Franquicia\" : \"00626\",\"Modalidad\" : null,\"TipoContrato\" : null,\"FormaJuridica\" : null,\"TipoCliente\" : null,\"Telefono\" : null,\"EsGenerico\" : false},\"DatosEntregaSabado\" : null,\"DatosSeguroOpcional\" : null,\"DatosRetorno\" : null,\"DatosGestion\" : null,\"DatosCire\" : null,\"DatosReembolso\" : null}";
                });
                for (int i = 0; i < 1000000; i++)
                {
                    busPublisher.Publish(messageBasic);
                }
            }
        }
    }
}
